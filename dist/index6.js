"use strict";(()=>{var S={1:{cssProperty:"-webkit-text-stroke-width",min:1,max:10},2:{cssProperty:"font-variation-settings",min:25,max:152},3:{cssProperty:"font-variation-settings",min:100,max:900},4:{cssProperty:"border-radius",min:0,max:32},5:{cssProperty:"opacity",min:0,max:100},6:{cssProperty:"box-shadow",min:0,max:30},7:{cssProperty:"box-shadow",min:0,max:360},8:{cssProperty:"padding",min:0,max:50}},g=4,q=20,k=2,B=1;var s={SUCCESS:"is-success",ERROR:"is-error",ACTIVE:"is-active",SHAKE:"shake-element"};function $(t,e){t-=90,t<0&&(t+=360);let r=t*(Math.PI/180),o=Math.floor(e*Math.cos(r)),n=Math.floor(e*Math.sin(r));return{offsetX:o,offsetY:n}}function L(t){let e=Math.floor(t/60),r=(t%60).toFixed(2);return`${e.toString().padStart(2,"0")}:${r.toString().padStart(5,"0")}`}function G(t){let e=Math.floor(t/60),r=t%60,o=e===1?"minute":"minutes",n=r===1?"second":"seconds";return e===0?`${r.toFixed(2)} ${n}`:`${e} ${o} and ${r.toFixed(2)} ${n}`}var y=class{constructor(e,r){this.startTime=e;this.timeElement=r;this.countup=0;this.eventCallbacks={};this.timeElapsed=this.startTime,this.timeElement.textContent=L(this.timeElapsed)}on(e,r){this.eventCallbacks[e]||(this.eventCallbacks[e]=[]),this.eventCallbacks[e].push(r)}emit(e){this.eventCallbacks[e]&&this.eventCallbacks[e].forEach(r=>r())}start(){let e=performance.now(),r=e,o=()=>{let n=performance.now(),a=(n-e)/1e3;this.timeElapsed=this.startTime+a,this.timeElement&&(this.timeElement.textContent=L(this.timeElapsed)),r=n,this.countup=requestAnimationFrame(o)};this.countup=requestAnimationFrame(o)}stop(){clearInterval(this.countup)}reset(){this.stop(),this.timeElapsed=this.startTime,this.timeElement.textContent=L(this.timeElapsed)}getTime(){let e=this.timeElapsed+performance.now()%1e3/1e3;return Number(e.toFixed(2))}getAccurateTime(){return(this.timeElapsed+performance.now()%1e3/1e3).toFixed(2)}};var M=class{constructor(e,r,o,n,a,f,R,A,O,U,Z,ee,te=!1){this.levelNumber=e,this.targetValue=r,this.userSelection=o,this.displayUserSelectionElement=n,this.referenceEl=a,this.targetElProperty=f,this.min=R,this.max=A,this.targetEl=O,this.userSelectEl=U,this.messageEl=Z,this.score=ee,this.isCircular=te,this.updateGameUI()}play(){this.referenceEl.style.setProperty(this.targetElProperty,this.formatPropertyValueToStringForLevel(this.levelNumber,this.targetValue)),this.userSelectEl.addEventListener("input",e=>{this.userSelection=parseInt(e.target.value),this.updateGameUI()})}updateGameUI(){this.displayUserSelectionElement&&(this.displayUserSelectionElement.textContent=`${this.userSelection}`),this.targetEl&&this.targetEl.style.setProperty(this.targetElProperty,this.formatPropertyValueToStringForLevel(this.levelNumber,this.userSelection))}checkAnswer(){let e,r;if(this.isCircular)e=Math.abs(this.targetValue-this.userSelection),e=Math.min(e,360-e),r=e/360*100;else{e=Math.abs(this.targetValue-this.userSelection);let o=this.max-this.min;r=e/o*100}return console.log(`target: ${this.targetValue} user: ${this.userSelection}`),console.log(`difference: ${e} percentage: ${r}`),r<=g}getRandomInt(e,r){return Math.floor(Math.random()*(r-e+1))+e}setTargetValue(e,r){this.targetValue=this.getRandomInt(e,r)}formatPropertyValueToStringForLevel(e,r){if(e===1)return`${r}px`;if(e===2)return`"wdth" ${r}`;if(e===3)return`"wght" ${r}`;if(e===4)return`${r}px`;if(e===5)return`${r}%`;if(e===6){let o=getComputedStyle(this.referenceEl).boxShadow;console.log("Box Shadow String:",o);let n=o.split(" ");return n[5]=`${r}px`,n.join(" ")}if(e===7){let n=getComputedStyle(this.referenceEl).boxShadow.split(" "),a=parseInt(n[4],10),f=parseInt(n[5],10),R=Math.sqrt(a*a+f*f),{offsetX:A,offsetY:O}=$(r,R);return n[4]=`${A}px`,n[5]=`${O}px`,n.join(" ")}return e===8?`${r}px`:""}};var N=class{constructor(e){this.scoreElement=e;this.currentScore=0;this.scoreElement.textContent=this.currentScore.toString()}updateScore(e,r,o=!1){let n=this.calculateScore(e,r,o);return this.currentScore+=n,this.scoreElement.textContent=this.currentScore.toString(),n}calculateScore(e,r,o=!1){let n,a;return o?(n=Math.abs(e-r),n=Math.min(n,360-n),a=n/360*100):(n=Math.abs(e-r),a=n/e*100),a<=g?k:a<=q?B:0}reset(){this.currentScore=0,this.scoreElement.textContent=this.currentScore.toString()}getScore(){return this.currentScore}};var{fetch:ne}=window;var oe=document.querySelectorAll('[data-game="reference-el"]'),se=document.querySelectorAll('[data-game="target-el"]'),ie=document.querySelectorAll('[data-game="display-user-selection"]'),b=document.querySelectorAll('[data-game="user-select-el"]'),_=document.querySelectorAll('[data-game="submit-button"]'),P=document.querySelectorAll('[data-game="next-button"]'),i=document.querySelector('[data-game="message-el"]'),I=document.querySelectorAll(".w-tab-link"),H=document.querySelector('[data-game="time-remaining"]'),V=document.querySelector('[data-game="score"]'),T=document.querySelector('[data-game="round-number"]'),Y=document.querySelector('[data-game="start-game"]'),E=document.querySelector('[data-game="countdown"]'),p=document.querySelector('[data-game="intro"]'),u=document.querySelector('[data-game="game"]'),h=document.querySelector('[data-game="end"]'),w=document.querySelector('[data-game="end-text"]'),W=document.querySelector('[data-game="try-again"]'),l=document.querySelector('[data-game="glow-top-embed"]'),x=document.querySelector('[data-game="penalty-overlay"]'),C=document.querySelector('[data-game="game-window"]'),K=document.querySelector('[data-game="name"]'),X=document.querySelector('[data-game="email"]'),Re=document.querySelector('[fs-social-share="content"]');if(!K||!X)throw new Error("Error retrieving name or email elements.");var c=1,m=[],ae=Object.keys(S).length;if(!V||!T||!i||!H||!E||!p||!u||!h||!w||!W||!Y||!l||!x||!C)throw new Error("Error retrieving necessary game elements.");var v=new N(V),d=new y(0,H);T.textContent=c.toString().padStart(2,"0");Q();function j(){m.length=0;for(let t=1;t<=ae;t++){if(!i||!H)throw new Error("Message and timer elements are required");let e=new M(t,de(parseInt(b[t-1].min,10),parseInt(b[t-1].max,10)),parseInt(b[t-1].value,10),ie[t-1],oe[t-1],S[t].cssProperty,S[t].min,S[t].max,se[t-1],b[t-1],i,v,t===7);m.push(e)}}function ce(){if(!p||!u||!E)throw new Error("Intro and game elements are required");if(!E)throw new Error("Countdown element is required");p.style.setProperty("display","none"),u.style.setProperty("display","flex"),u.style.setProperty("align-items","center"),j(),m[c-1].play();let t=setInterval(()=>{let e=parseInt(E.textContent||"3",10);e===1?(clearInterval(t),D(I[c]),d.start(),m[c-1].play()):E.textContent=(e-1).toString()},1e3)}function le(){if(!T||!E||!v||!d)throw new Error("Error resetting the game");E.textContent="3",v.reset(),d.reset(),c=1,D(I[0]),T.textContent=c.toString().padStart(2,"0"),j(),_.forEach(t=>{t.style.setProperty("display","block")}),P.forEach(t=>{t.style.setProperty("display","none")})}function z(){if(d.stop(),!u||!h||!w)throw new Error("Game and end elements are required");let t=document.querySelector('[data-game="social-content"]'),e=G(d.getTime()),r=`I beat the Eyeballing Game in ${e}! Can you beat my time? Give it a try!`;w.textContent=`Congratulations! You finished the game in ${e}.`,t&&t.setAttribute("fs-social-share",r),u.style.setProperty("display","none"),h.style.setProperty("display","flex"),h.style.setProperty("align-items","center"),ne("https://hooks.zapier.com/hooks/catch/14554026/3my5lpi/",{method:"POST",body:JSON.stringify({time:d.getAccurateTime(),name:K.value,email:X.value})}).then(o=>o.json()).then(o=>console.log("Success:",o)).catch(o=>console.error("Error:",o))}function Ee(t){if(!(!i||!l||!x||!C))if(t)l.classList.add(s.SUCCESS),i.classList.add(s.SUCCESS),i.textContent="Congratulations! You nailed it",ue(),setTimeout(()=>{l.classList.remove(s.SUCCESS)},800);else{let e=(5e3-1)/1e3;i.textContent=`Incorrect! Try again in ${Math.round(e)} ${e===1?"second":"seconds"}.`,x.classList.add(s.ACTIVE),l.classList.add(s.ERROR),i.classList.add(s.ERROR),C.classList.add(s.SHAKE),setTimeout(()=>{C.classList.remove(s.SHAKE)},500);let r=setInterval(()=>{i.textContent=`Incorrect! Try again in ${Math.round(e)} ${e===1?"second":"seconds"}.`,e-=1},1e3);setTimeout(()=>{clearInterval(r),x.classList.remove(s.ACTIVE),l.classList.remove(s.ERROR),i.classList.remove(s.ERROR)},5e3)}}Y.addEventListener("click",()=>{ce()});document.addEventListener("keydown",t=>{t.key==="q"&&z()});_.forEach(t=>{t.addEventListener("click",me)});P.forEach(t=>{t.addEventListener("click",J)});W.addEventListener("click",()=>{le(),h.style.setProperty("display","none"),p.style.setProperty("display","flex"),p.style.setProperty("align-items","center")});function me(){if(!i||!l)return;let t=m[c-1].checkAnswer();Ee(t)}function J(){if(!T)throw new Error("Round element is required");!l||!i||(c+=1,l.classList.remove(s.SUCCESS),i.classList.remove(s.SUCCESS),c<=m.length?(T.textContent=c.toString().padStart(2,"0"),D(I[c]),m[c-1].play(),setTimeout(()=>{Q()},200)):z())}function ue(){_.forEach(t=>{t.style.setProperty("display","none")}),setTimeout(()=>{J()},1e3)}function Q(){_.forEach(t=>{t.style.setProperty("display","block")}),P.forEach(t=>{t.style.setProperty("display","none")})}function de(t,e){return Math.floor(Math.random()*(e-t+1))+t}function D(t){let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});t.dispatchEvent(e)}})();
