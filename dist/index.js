"use strict";(()=>{var v={1:"-webkit-text-stroke-width",2:"font-variation-settings",3:"font-variation-settings",4:"border-radius",5:"opacity",6:"box-shadow",7:"box-shadow"},h=10,k=20,B=2,q=1;var o={SUCCESS:"is-success",ERROR:"is-error",ACTIVE:"is-active",SHAKE:"shake-element"};function $(t,e){t-=90,t<0&&(t+=360);let r=t*(Math.PI/180),i=Math.floor(e*Math.cos(r)),n=Math.floor(e*Math.sin(r));return{offsetX:i,offsetY:n}}function p(t){let e=Math.floor(t/60),r=t%60;return`${e.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function G(t){let e=Math.floor(t/60),r=t%60,i=e===1?"minute":"minutes",n=r===1?"second":"seconds";return e===0?`${r} ${n}`:`${e} ${i} and ${r} ${n}`}var f=class{constructor(e,r){this.startTime=e;this.timeElement=r;this.countup=0;this.eventCallbacks={};this.timeElapsed=this.startTime,this.timeElement.textContent=p(this.timeElapsed)}on(e,r){this.eventCallbacks[e]||(this.eventCallbacks[e]=[]),this.eventCallbacks[e].push(r)}emit(e){this.eventCallbacks[e]&&this.eventCallbacks[e].forEach(r=>r())}start(){this.countup=setInterval(()=>{this.timeElapsed+=1,this.timeElement.textContent=p(this.timeElapsed)},1e3)}stop(){clearInterval(this.countup)}reset(){this.stop(),this.timeElapsed=this.startTime,this.timeElement.textContent=p(this.timeElapsed)}getTime(){return this.timeElapsed}};var L=class{constructor(e,r,i,n,l,T,R,b,O,U,X=!1){this.levelNumber=e,this.targetValue=r,this.userSelection=i,this.displayUserSelectionElement=n,this.referenceEl=l,this.targetElProperty=T,this.targetEl=R,this.userSelectEl=b,this.messageEl=O,this.score=U,this.isCircular=X,this.updateGameUI()}play(){this.referenceEl.style.setProperty(this.targetElProperty,this.formatPropertyValueToStringForLevel(this.levelNumber,this.targetValue)),this.userSelectEl.addEventListener("input",e=>{this.userSelection=parseInt(e.target.value),this.updateGameUI()})}updateGameUI(){this.displayUserSelectionElement.textContent=`${this.userSelection}`,this.targetEl.style.setProperty(this.targetElProperty,this.formatPropertyValueToStringForLevel(this.levelNumber,this.userSelection))}checkAnswer(){let e,r;return this.isCircular?(e=Math.abs(this.targetValue-this.userSelection),e=Math.min(e,360-e),r=e/360*100):(e=Math.abs(this.targetValue-this.userSelection),r=e/this.targetValue*100),console.log(`target: ${this.targetValue} user: ${this.userSelection}`),console.log(`difference: ${e} percentage: ${r}`),r<=h}formatPropertyValueToStringForLevel(e,r){if(e===1)return`${r}px`;if(e===2)return`"wdth" ${r}`;if(e===3)return`"wght" ${r}`;if(e===4)return`${r}px`;if(e===5)return`${r}%`;if(e===6){let n=getComputedStyle(this.referenceEl).boxShadow.split(" ");return n[4]=`${r}px`,n.join(" ")}if(e===7){let n=getComputedStyle(this.referenceEl).boxShadow.split(" "),l=parseInt(n[4],10),T=parseInt(n[5],10),R=Math.sqrt(l*l+T*T),{offsetX:b,offsetY:O}=$(r,R);return n[4]=`${b}px`,n[5]=`${O}px`,n.join(" ")}return""}};var g=class{constructor(e){this.scoreElement=e;this.currentScore=0;this.scoreElement.textContent=this.currentScore.toString()}updateScore(e,r,i=!1){let n=this.calculateScore(e,r,i);return this.currentScore+=n,this.scoreElement.textContent=this.currentScore.toString(),n}calculateScore(e,r,i=!1){let n,l;return i?(n=Math.abs(e-r),n=Math.min(n,360-n),l=n/360*100):(n=Math.abs(e-r),l=n/e*100),l<=h?B:l<=k?q:0}reset(){this.currentScore=0,this.scoreElement.textContent=this.currentScore.toString()}getScore(){return this.currentScore}};var z=document.querySelectorAll('[data-game="reference-el"]'),J=document.querySelectorAll('[data-game="target-el"]'),Q=document.querySelectorAll('[data-game="display-user-selection"]'),M=document.querySelectorAll('[data-game="user-select-el"]'),w=document.querySelectorAll('[data-game="submit-button"]'),I=document.querySelectorAll('[data-game="next-button"]'),s=document.querySelector('[data-game="message-el"]'),P=document.querySelectorAll(".w-tab-link"),D=document.querySelector('[data-game="time-remaining"]'),F=document.querySelector('[data-game="score"]'),m=document.querySelector('[data-game="round-number"]'),Y=document.querySelector('[data-game="start-game"]'),E=document.querySelector('[data-game="countdown"]'),_=document.querySelector('[data-game="intro"]'),u=document.querySelector('[data-game="game"]'),C=document.querySelector('[data-game="end"]'),A=document.querySelector('[data-game="end-text"]'),W=document.querySelector('[data-game="try-again"]'),c=document.querySelector('[data-game="glow-top-embed"]'),y=document.querySelector('[data-game="penalty-overlay"]'),N=document.querySelector('[data-game="game-window"]'),a=1,d=[],Z=Object.keys(v).length;if(!F||!m||!s||!D||!E||!_||!u||!C||!A||!W||!Y||!c||!y||!N)throw new Error("Error retrieving necessary game elements.");var x=new g(F),S=new f(0,D);m.textContent=a.toString().padStart(2,"0");K();for(let t=1;t<=Z;t++){if(!s||!D)throw new Error("Message and timer elements are required");let e=new L(t,ae(parseInt(M[t-1].min,10),parseInt(M[t-1].max,10)),parseInt(M[t-1].value,10),Q[t-1],z[t-1],v[t],J[t-1],M[t-1],s,x,t===7);d.push(e)}function ee(){if(!_||!u||!E)throw new Error("Intro and game elements are required");if(!E)throw new Error("Countdown element is required");_.style.setProperty("display","none"),u.style.setProperty("display","block");let t=setInterval(()=>{let e=parseInt(E.textContent||"3",10);e===1?(clearInterval(t),H(P[a]),S.start(),d[a-1].play()):E.textContent=(e-1).toString()},1e3)}function te(){if(!m||!E||!x||!S)throw new Error("Error resetting the game");E.textContent="3",x.reset(),S.reset(),a=1,H(P[0]),m.textContent=a.toString().padStart(2,"0")}function re(){if(S.stop(),!u||!C||!A)throw new Error("Game and end elements are required");let t=G(S.getTime());A.textContent=`Congratulations! You finished the game in ${t}.`,u.style.setProperty("display","none"),C.style.setProperty("display","block")}function ne(t){if(!(!s||!c||!y||!N))if(t)c.classList.add(o.SUCCESS),s.classList.add(o.SUCCESS),s.textContent="Congratulations! You nailed it",ie();else{let e=(5e3-1)/1e3;s.textContent=`Incorrect! Try again in ${Math.round(e)} ${e===1?"second":"seconds"}.`,y.classList.add(o.ACTIVE),c.classList.add(o.ERROR),s.classList.add(o.ERROR),N.classList.add(o.SHAKE),setTimeout(()=>{N.classList.remove(o.SHAKE)},500);let r=setInterval(()=>{s.textContent=`Incorrect! Try again in ${Math.round(e)} ${e===1?"second":"seconds"}.`,e-=1},1e3);setTimeout(()=>{clearInterval(r),y.classList.remove(o.ACTIVE),c.classList.remove(o.ERROR),s.classList.remove(o.ERROR)},5e3)}}Y.addEventListener("click",()=>{ee()});w.forEach(t=>{t.addEventListener("click",oe)});I.forEach(t=>{t.addEventListener("click",se)});W.addEventListener("click",()=>{te(),C.style.setProperty("display","none"),_.style.setProperty("display","block")});function oe(){if(!s||!c)return;let t=d[a-1].checkAnswer();ne(t)}function se(){if(!m)throw new Error("Round element is required");!c||!s||(a+=1,c.classList.remove(o.SUCCESS),s.classList.remove(o.SUCCESS),a<=d.length?(m.textContent=a.toString().padStart(2,"0"),H(P[a]),d[a-1].play(),K()):re())}function ie(){w.forEach(t=>{t.style.setProperty("display","none")}),I.forEach(t=>{t.style.setProperty("display","block")})}function K(){w.forEach(t=>{t.style.setProperty("display","block")}),I.forEach(t=>{t.style.setProperty("display","none")})}function ae(t,e){return Math.floor(Math.random()*(e-t+1))+t}function H(t){let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});t.dispatchEvent(e)}})();
