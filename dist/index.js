"use strict";(()=>{var u={1:{cssProperty:"-webkit-text-stroke-width",min:1,max:10},2:{cssProperty:"font-variation-settings",min:25,max:152},3:{cssProperty:"font-variation-settings",min:100,max:900},4:{cssProperty:"border-radius",min:0,max:32},5:{cssProperty:"opacity",min:0,max:100},6:{cssProperty:"box-shadow",min:0,max:30},7:{cssProperty:"box-shadow",min:0,max:360}},p=10,k=20,B=2,q=1;var s={SUCCESS:"is-success",ERROR:"is-error",ACTIVE:"is-active",SHAKE:"shake-element"};function $(t,e){t-=90,t<0&&(t+=360);let r=t*(Math.PI/180),o=Math.floor(e*Math.cos(r)),n=Math.floor(e*Math.sin(r));return{offsetX:o,offsetY:n}}function f(t){let e=Math.floor(t/60),r=t%60;return`${e.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}function G(t){let e=Math.floor(t/60),r=t%60,o=e===1?"minute":"minutes",n=r===1?"second":"seconds";return e===0?`${r} ${n}`:`${e} ${o} and ${r} ${n}`}var L=class{constructor(e,r){this.startTime=e;this.timeElement=r;this.countup=0;this.eventCallbacks={};this.timeElapsed=this.startTime,this.timeElement.textContent=f(this.timeElapsed)}on(e,r){this.eventCallbacks[e]||(this.eventCallbacks[e]=[]),this.eventCallbacks[e].push(r)}emit(e){this.eventCallbacks[e]&&this.eventCallbacks[e].forEach(r=>r())}start(){this.countup=setInterval(()=>{this.timeElapsed+=1,this.timeElement.textContent=f(this.timeElapsed)},1e3)}stop(){clearInterval(this.countup)}reset(){this.stop(),this.timeElapsed=this.startTime,this.timeElement.textContent=f(this.timeElapsed)}getTime(){return this.timeElapsed}};var g=class{constructor(e,r,o,n,l,h,C,x,O,U,X,j,z=!1){this.levelNumber=e,this.targetValue=r,this.userSelection=o,this.displayUserSelectionElement=n,this.referenceEl=l,this.targetElProperty=h,this.min=C,this.max=x,this.targetEl=O,this.userSelectEl=U,this.messageEl=X,this.score=j,this.isCircular=z,this.updateGameUI()}play(){this.referenceEl.style.setProperty(this.targetElProperty,this.formatPropertyValueToStringForLevel(this.levelNumber,this.targetValue)),this.userSelectEl.addEventListener("input",e=>{this.userSelection=parseInt(e.target.value),this.updateGameUI()})}updateGameUI(){this.displayUserSelectionElement.textContent=`${this.userSelection}`,this.targetEl.style.setProperty(this.targetElProperty,this.formatPropertyValueToStringForLevel(this.levelNumber,this.userSelection))}checkAnswer(){let e,r;if(this.isCircular)e=Math.abs(this.targetValue-this.userSelection),e=Math.min(e,360-e),r=e/360*100;else{e=Math.abs(this.targetValue-this.userSelection);let o=this.max-this.min;r=e/o*100}return console.log(`target: ${this.targetValue} user: ${this.userSelection}`),console.log(`difference: ${e} percentage: ${r}`),r<=p}formatPropertyValueToStringForLevel(e,r){if(e===1)return`${r}px`;if(e===2)return`"wdth" ${r}`;if(e===3)return`"wght" ${r}`;if(e===4)return`${r}px`;if(e===5)return`${r}%`;if(e===6){let n=getComputedStyle(this.referenceEl).boxShadow.split(" ");return n[4]=`${r}px`,n.join(" ")}if(e===7){let n=getComputedStyle(this.referenceEl).boxShadow.split(" "),l=parseInt(n[4],10),h=parseInt(n[5],10),C=Math.sqrt(l*l+h*h),{offsetX:x,offsetY:O}=$(r,C);return n[4]=`${x}px`,n[5]=`${O}px`,n.join(" ")}return""}};var y=class{constructor(e){this.scoreElement=e;this.currentScore=0;this.scoreElement.textContent=this.currentScore.toString()}updateScore(e,r,o=!1){let n=this.calculateScore(e,r,o);return this.currentScore+=n,this.scoreElement.textContent=this.currentScore.toString(),n}calculateScore(e,r,o=!1){let n,l;return o?(n=Math.abs(e-r),n=Math.min(n,360-n),l=n/360*100):(n=Math.abs(e-r),l=n/e*100),l<=p?B:l<=k?q:0}reset(){this.currentScore=0,this.scoreElement.textContent=this.currentScore.toString()}getScore(){return this.currentScore}};var Q=document.querySelectorAll('[data-game="reference-el"]'),Z=document.querySelectorAll('[data-game="target-el"]'),ee=document.querySelectorAll('[data-game="display-user-selection"]'),M=document.querySelectorAll('[data-game="user-select-el"]'),P=document.querySelectorAll('[data-game="submit-button"]'),w=document.querySelectorAll('[data-game="next-button"]'),i=document.querySelector('[data-game="message-el"]'),I=document.querySelectorAll(".w-tab-link"),D=document.querySelector('[data-game="time-remaining"]'),Y=document.querySelector('[data-game="score"]'),m=document.querySelector('[data-game="round-number"]'),F=document.querySelector('[data-game="start-game"]'),E=document.querySelector('[data-game="countdown"]'),b=document.querySelector('[data-game="intro"]'),d=document.querySelector('[data-game="game"]'),_=document.querySelector('[data-game="end"]'),v=document.querySelector('[data-game="end-text"]'),W=document.querySelector('[data-game="try-again"]'),c=document.querySelector('[data-game="glow-top-embed"]'),N=document.querySelector('[data-game="penalty-overlay"]'),R=document.querySelector('[data-game="game-window"]'),a=1,S=[],te=Object.keys(u).length;if(!Y||!m||!i||!D||!E||!b||!d||!_||!v||!W||!F||!c||!N||!R)throw new Error("Error retrieving necessary game elements.");var A=new y(Y),T=new L(0,D);m.textContent=a.toString().padStart(2,"0");K();for(let t=1;t<=te;t++){if(!i||!D)throw new Error("Message and timer elements are required");let e=new g(t,ce(parseInt(M[t-1].min,10),parseInt(M[t-1].max,10)),parseInt(M[t-1].value,10),ee[t-1],Q[t-1],u[t].cssProperty,u[t].min,u[t].max,Z[t-1],M[t-1],i,A,t===7);S.push(e)}function re(){if(!b||!d||!E)throw new Error("Intro and game elements are required");if(!E)throw new Error("Countdown element is required");b.style.setProperty("display","none"),d.style.setProperty("display","block");let t=setInterval(()=>{let e=parseInt(E.textContent||"3",10);e===1?(clearInterval(t),H(I[a]),T.start(),S[a-1].play()):E.textContent=(e-1).toString()},1e3)}function ne(){if(!m||!E||!A||!T)throw new Error("Error resetting the game");E.textContent="3",A.reset(),T.reset(),a=1,H(I[0]),m.textContent=a.toString().padStart(2,"0")}function oe(){if(T.stop(),!d||!_||!v)throw new Error("Game and end elements are required");let t=G(T.getTime());v.textContent=`Congratulations! You finished the game in ${t}.`,d.style.setProperty("display","none"),_.style.setProperty("display","block")}function se(t){if(!(!i||!c||!N||!R))if(t)c.classList.add(s.SUCCESS),i.classList.add(s.SUCCESS),i.textContent="Congratulations! You nailed it",le();else{let e=(5e3-1)/1e3;i.textContent=`Incorrect! Try again in ${Math.round(e)} ${e===1?"second":"seconds"}.`,N.classList.add(s.ACTIVE),c.classList.add(s.ERROR),i.classList.add(s.ERROR),R.classList.add(s.SHAKE),setTimeout(()=>{R.classList.remove(s.SHAKE)},500);let r=setInterval(()=>{i.textContent=`Incorrect! Try again in ${Math.round(e)} ${e===1?"second":"seconds"}.`,e-=1},1e3);setTimeout(()=>{clearInterval(r),N.classList.remove(s.ACTIVE),c.classList.remove(s.ERROR),i.classList.remove(s.ERROR)},5e3)}}F.addEventListener("click",()=>{re()});P.forEach(t=>{t.addEventListener("click",ie)});w.forEach(t=>{t.addEventListener("click",ae)});W.addEventListener("click",()=>{ne(),_.style.setProperty("display","none"),b.style.setProperty("display","block")});function ie(){if(!i||!c)return;let t=S[a-1].checkAnswer();se(t)}function ae(){if(!m)throw new Error("Round element is required");!c||!i||(a+=1,c.classList.remove(s.SUCCESS),i.classList.remove(s.SUCCESS),a<=S.length?(m.textContent=a.toString().padStart(2,"0"),H(I[a]),S[a-1].play(),K()):oe())}function le(){P.forEach(t=>{t.style.setProperty("display","none")}),w.forEach(t=>{t.style.setProperty("display","block")})}function K(){P.forEach(t=>{t.style.setProperty("display","block")}),w.forEach(t=>{t.style.setProperty("display","none")})}function ce(t,e){return Math.floor(Math.random()*(e-t+1))+t}function H(t){let e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});t.dispatchEvent(e)}})();
